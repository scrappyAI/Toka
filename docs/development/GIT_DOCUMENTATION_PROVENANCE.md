# Git-Based Documentation Provenance & AI Code Tracking System

**Date:** 2025-07-11  
**Version:** 1.0.0  
**Status:** Production Ready  

## Overview

This system provides comprehensive tracking of AI-generated code, documentation link validation, and audit trail generation using Git as the foundation. It addresses critical issues like LLM hallucinations, broken documentation links, and lack of AI code provenance.

## üéØ Key Features

### **AI Code Provenance Tracking**
- **Automatic Detection**: Identifies AI-generated content in commits
- **Metadata Tracking**: Records AI model, confidence level, human review status
- **Commit Trailers**: Embeds provenance data directly in Git commits
- **Search & Query**: Find AI-generated code by model, date, or type

### **Documentation Link Validation**
- **Broken Link Detection**: Validates all internal documentation links
- **Cross-Reference Mapping**: Maintains a graph of document relationships
- **Automatic Reporting**: Generates link validation reports
- **CI/CD Integration**: Blocks commits with broken documentation links

### **Date Accuracy Enforcement**
- **Hallucination Prevention**: Detects and prevents LLM date hallucinations
- **Deterministic Dating**: Uses canonical sources for all dates
- **Suspicious Pattern Detection**: Identifies common AI dating errors
- **Exemption System**: Allows intentional historical dates with citations

### **Comprehensive Audit Trails**
- **Commit-Level Tracking**: Every commit gets a provenance record
- **File-Level Metadata**: Detailed tracking of individual file changes
- **Audit Reports**: Automated generation of comprehensive audit reports
- **Long-term Retention**: Maintains historical provenance data

## üöÄ Quick Start

### Installation

```bash
# Run the setup script
./scripts/setup-git-provenance.sh

# This will:
# - Install Git hooks
# - Configure Git settings
# - Initialize provenance tracking
# - Create audit configuration
# - Set up CI/CD integration
```

### Basic Usage

```bash
# Track AI-generated file
./scripts/git-doc-provenance.sh track src/main.rs claude-3.5-sonnet code high true

# Validate documentation links
./scripts/git-doc-provenance.sh validate

# Generate audit report
./scripts/git-doc-provenance.sh audit

# Commit with AI provenance
./scripts/git-doc-provenance.sh commit "feat: add new feature" claude-3.5-sonnet src/main.rs

# Search AI-generated code
./scripts/git-doc-provenance.sh search model claude-3.5-sonnet
```

## üìã System Architecture

### **Core Components**

1. **`git-doc-provenance.sh`** - Main tracking and validation script
2. **Pre-commit Hook** - Validates commits before they're created
3. **Post-commit Hook** - Finalizes provenance tracking after commits
4. **Audit Configuration** - `.doc-audit.yaml` for system configuration
5. **CI/CD Integration** - GitHub Actions workflow for automated validation

### **Data Storage**

```
.git/provenance/
‚îú‚îÄ‚îÄ ai-generations.jsonl      # AI-generated file tracking
‚îú‚îÄ‚îÄ doc-linkage.json          # Documentation link validation
‚îú‚îÄ‚îÄ audit-report-*.json       # Audit reports
‚îú‚îÄ‚îÄ audit.log                 # System audit log
‚îî‚îÄ‚îÄ commit-*.json             # Individual commit provenance records
```

### **Git Integration**

```
.git/
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îú‚îÄ‚îÄ pre-commit           # Quality checks and validation
‚îÇ   ‚îî‚îÄ‚îÄ post-commit          # Provenance finalization
‚îú‚îÄ‚îÄ provenance/              # Provenance data storage
‚îî‚îÄ‚îÄ COMMIT_METADATA          # Temporary commit metadata
```

## üîß Configuration

### **Audit Configuration (`.doc-audit.yaml`)**

```yaml
# Documentation Audit Configuration
version: "1.0.0"
description: "Configuration for automated documentation auditing and AI provenance tracking"

# Documentation directories to audit
documentation_paths:
  - "docs/"
  - "README.md"
  - "CHANGELOG.md"
  - "*.md"

# Link validation settings
link_validation:
  check_internal: true
  check_external: false
  external_timeout: 10
  ignore_patterns:
    - "mailto:"
    - "javascript:"
    - "#"

# AI provenance tracking settings
ai_tracking:
  auto_detect: true
  model_patterns:
    - "claude-[0-9.-]+"
    - "gpt-[0-9.-]+"
    - "anthropic"
    - "openai"
  content_markers:
    - "AI-Generated"
    - "Generated by"
    - "AI-assisted"
    - "LLM"

# Date validation settings
date_validation:
  check_future_dates: true
  check_suspicious_patterns: true
  exempt_marker: "DATE:EXEMPT"

# Audit report settings
audit_reports:
  auto_generate: true
  format: "json"
  retention_days: 30
  detailed_analysis: true
```

### **Git Configuration**

The system automatically configures Git with:
- Commit trailers for AI metadata
- Commit message template with AI provenance prompts
- Hook configuration for automatic validation

## üîç AI Provenance Tracking

### **Automatic Detection**

The system automatically detects AI-generated content by looking for:
- **Content Markers**: "AI-Generated", "Generated by", "AI-assisted", "LLM"
- **Model References**: "claude-3.5-sonnet", "gpt-4", "anthropic", "openai"
- **Commit Trailers**: Structured metadata in commit messages

### **Manual Tracking**

```bash
# Track a specific file
./scripts/git-doc-provenance.sh track <file> <ai_model> <type> <confidence> <human_review>

# Example
./scripts/git-doc-provenance.sh track src/auth.rs claude-3.5-sonnet code high true
```

### **Commit Integration**

When committing AI-generated content, use commit trailers:

```
feat(auth): implement JWT token validation

This commit adds JWT token validation with secure key rotation.

AI-Generated: true
AI-Model: claude-3.5-sonnet
AI-Confidence: high
Human-Review: true
Provenance-Tracked: true
```

### **Search and Query**

```bash
# Search by AI model
./scripts/git-doc-provenance.sh search model claude-3.5-sonnet

# Search by date
./scripts/git-doc-provenance.sh search date 2025-07-11

# Search by commit hash
./scripts/git-doc-provenance.sh search commit abc123

# Search by generation type
./scripts/git-doc-provenance.sh search type documentation

# List all AI-generated files
./scripts/git-doc-provenance.sh search all
```

## üìö Documentation Link Validation

### **Validation Process**

The system validates:
- **Internal Links**: Links to other files in the repository
- **Relative Paths**: `../docs/file.md`, `./README.md`
- **Absolute Paths**: `/docs/architecture/spec.md`
- **Anchor Links**: `file.md#section`

### **Broken Link Detection**

```bash
# Run validation
./scripts/git-doc-provenance.sh validate

# Example output
[INFO] Validating documentation cross-references...
[WARN] Broken link found: docs/README.md -> ../missing-file.md
[ERROR] Found 1 broken documentation links
```

### **Validation Report**

```json
{
    "last_updated": "2025-07-12T10:30:00Z",
    "validation_commit": "abc123def",
    "total_links": 150,
    "valid_links": 149,
    "broken_links": 1,
    "broken_link_details": [
        "docs/README.md: ../missing-file.md"
    ]
}
```

## üìä Audit Reports

### **Comprehensive Audit**

```bash
# Generate audit report
./scripts/git-doc-provenance.sh audit

# Example output
=== Documentation Audit Summary ===
Timestamp: 2025-07-12T10:30:00Z
Commit: abc123de
Total Docs: 45
AI Generations: 12
Valid Links: 149
Broken Links: 1
```

### **Audit Report Structure**

```json
{
    "audit_timestamp": "2025-07-12T10:30:00Z",
    "commit_hash": "abc123def456",
    "git_branch": "main",
    "documentation_stats": {
        "total_markdown_files": 45,
        "total_size_bytes": 1048576,
        "recent_commits_1week": 8
    },
    "ai_generation_stats": {
        "total_ai_generations": 12,
        "ai_metadata_file": ".git/provenance/ai-generations.jsonl"
    },
    "link_validation": {
        "total_links": 150,
        "valid_links": 149,
        "broken_links": 1
    },
    "git_stats": {
        "total_commits": 256,
        "contributors": 5,
        "last_commit_date": "2025-07-12T10:25:00Z"
    }
}
```

## üõ°Ô∏è Date Accuracy Enforcement

### **Hallucination Prevention**

The system prevents LLM date hallucinations by:
- **Future Date Detection**: Flags dates in the future
- **Suspicious Patterns**: Identifies common AI dating errors
- **Canonical Sources**: Uses `date -u +%Y-%m-%d` for current dates
- **Git Timestamps**: Uses actual commit dates for releases

### **Exemption System**

For intentional historical dates, use the exemption marker:

```markdown
<!-- DATE:EXEMPT source="RFC 2119, published 1997-03-01" -->
RFC 2119 was finalized on 1997-03-01.
```

### **Common Hallucination Patterns**

The system detects these suspicious patterns:
- **January 28th**: Common AI hallucination (2025-07-11)
- **February 29th**: Invalid leap year dates
- **December 32nd**: Invalid dates (2025-12-32)
- **Future Dates**: Any date beyond today

## üîÑ CI/CD Integration

### **GitHub Actions Workflow**

The system includes a complete GitHub Actions workflow:

```yaml
name: Documentation Audit and AI Provenance

on:
  push:
    branches: [ main, develop ]
    paths:
      - 'docs/**'
      - '*.md'
      - 'scripts/git-doc-provenance.sh'
  pull_request:
    branches: [ main, develop ]
    paths:
      - 'docs/**'
      - '*.md'

jobs:
  audit-documentation:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
    
    - name: Setup dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y jq uuid-runtime
    
    - name: Initialize provenance tracking
      run: |
        chmod +x scripts/git-doc-provenance.sh
        ./scripts/git-doc-provenance.sh init
    
    - name: Validate documentation links
      run: |
        ./scripts/git-doc-provenance.sh validate
    
    - name: Generate audit report
      run: |
        ./scripts/git-doc-provenance.sh audit
    
    - name: Search for AI-generated content
      run: |
        echo "=== AI-Generated Content Report ==="
        ./scripts/git-doc-provenance.sh search all || true
    
    - name: Upload audit artifacts
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: documentation-audit
        path: |
          .git/provenance/audit-report-*.json
          .git/provenance/doc-linkage.json
        retention-days: 30
```

### **Integration Benefits**

- **Automated Validation**: Every PR gets documentation validation
- **Artifact Storage**: Audit reports are stored for historical analysis
- **Failure Prevention**: Broken links block PR merges
- **Transparency**: AI-generated content is clearly identified

## üîß Advanced Usage

### **Custom Validation Rules**

Extend the system by modifying `.doc-audit.yaml`:

```yaml
# Custom validation rules
custom_rules:
  - name: "API Documentation"
    pattern: "docs/api/**/*.md"
    requires_examples: true
    requires_version: true
  
  - name: "Architecture Docs"
    pattern: "docs/architecture/**/*.md"
    requires_diagrams: true
    requires_date: true
```

### **Integration with Existing Tools**

```bash
# Integrate with pre-existing hooks
cat >> .git/hooks/pre-commit << 'EOF'
# Add provenance tracking
./scripts/git-doc-provenance.sh validate
EOF

# Integrate with CI/CD pipelines
./scripts/git-doc-provenance.sh audit --format json > audit-report.json
```

### **Batch Operations**

```bash
# Track multiple files
for file in src/*.rs; do
    ./scripts/git-doc-provenance.sh track "$file" claude-3.5-sonnet code medium true
done

# Validate all documentation
find docs/ -name "*.md" -exec ./scripts/git-doc-provenance.sh validate {} \;
```

## üö® Troubleshooting

### **Common Issues**

1. **Broken Link False Positives**
   ```bash
   # Check file existence
   ls -la docs/missing-file.md
   
   # Update link validation
   ./scripts/git-doc-provenance.sh validate
   ```

2. **AI Detection Not Working**
   ```bash
   # Check content markers
   grep -r "AI-Generated\|Claude\|GPT" src/
   
   # Manual tracking
   ./scripts/git-doc-provenance.sh track src/file.rs claude-3.5-sonnet
   ```

3. **Date Validation Errors**
   ```bash
   # Check for future dates
   grep -r "202[5-9]-" docs/
   
   # Add exemption marker
   echo "<!-- DATE:EXEMPT source=\"intentional future date\" -->" >> docs/file.md
   ```

4. **Hook Execution Issues**
   ```bash
   # Check hook permissions
   ls -la .git/hooks/
   
   # Reinstall hooks
   ./scripts/setup-git-provenance.sh
   ```

### **Debug Mode**

Enable debug logging:

```bash
# Set debug mode
export DEBUG=true

# Run with verbose output
./scripts/git-doc-provenance.sh validate --debug
```

## üìà Benefits & Impact

### **For AI Code Quality**
- **Transparency**: Clear identification of AI-generated content
- **Accountability**: Human review tracking for AI code
- **Traceability**: Complete audit trail from generation to deployment
- **Quality Assurance**: Automated validation of AI-generated content

### **For Documentation Quality**
- **Link Integrity**: Prevents broken documentation links
- **Cross-Reference Mapping**: Maintains document relationship graph
- **Automated Validation**: Continuous quality assurance
- **Historical Tracking**: Complete documentation change history

### **For Compliance & Audit**
- **Regulatory Compliance**: Detailed audit trails for compliance requirements
- **Risk Management**: Identification and tracking of AI-generated code risks
- **Change Management**: Complete history of all documentation changes
- **Quality Metrics**: Quantitative measures of documentation quality

## üîÆ Future Enhancements

### **Planned Features**
- **AI Model Comparison**: Compare output quality across different AI models
- **Semantic Link Analysis**: Understand document relationships beyond simple links
- **Automated Documentation Generation**: AI-powered documentation updates
- **Integration with IDEs**: Direct integration with development environments
- **Machine Learning**: Predictive models for documentation quality

### **Integration Opportunities**
- **Static Analysis Tools**: Integration with linting and analysis tools
- **Documentation Generators**: Integration with tools like Sphinx, GitBook
- **Project Management**: Integration with Jira, GitHub Issues
- **Security Scanning**: Integration with security analysis tools

---

## üìû Support & Contributing

For questions, issues, or contributions:
1. Check the troubleshooting section above
2. Review existing issues in the repository
3. Create a new issue with detailed information
4. Follow the contributing guidelines in `CONTRIBUTING.md`

This system represents a significant advancement in AI code provenance and documentation quality assurance, providing the foundation for transparent, auditable, and high-quality software development processes. 